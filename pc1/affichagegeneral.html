<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Informations générales</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  background: #f4f6f8;
  color: #1f2937;
  font-family: Arial, Helvetica, sans-serif;
   min-height: 100vh;
  display: grid;
  grid-template-rows: auto 1fr auto;
}

/* ===== HEADER ===== */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 30px;
  background: #ffffff;
  border-bottom: 3px solid #e5e7eb;
}

.header img { height: 60px; }
.header .date { font-size: 22px; }

/* ===== MAIN ===== */
.main {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 0;

  background-image: url("Slide1.jpg");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

.message-box {
  background: white;
  padding: 60px 80px;
  border-radius: 20px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.12);
  max-width: 70%;
  text-align: center;
}

.message {
  font-size: 56px;
  line-height: 1.4;
  white-space: pre-line;
  transition: opacity .5s;
}

/* ===== FOOTER ===== */
.footer {
  width: 100%;
  padding: 18px 30px;
  background: #ffffff;
  border-top: 3px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.time { font-size: 32px; font-weight: bold; }

.pc-select select {
  font-size: 18px;
  padding: 8px 12px;
  border-radius: 10px;
  border: 1px solid #cbd5e1;
}
</style>
</head>

<body>

<div class="header">
  <img src="data:image/png;base64,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" alt="Logo Trigano">

  <div class="date" id="date"></div>
</div>

<div class="main">
  <div class="message-box">
    <div class="message" id="message">Chargement…</div>
  </div>
</div>

<div class="footer">
  <div class="time" id="time"></div>
  <div class="pc-select">
    <select id="pcSelect"></select>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const SHEET_ID = "1rqtagt5yFWq7CCvMymb0ZPhnvoBoFc2KO3TChLhHmh0";
const SHEET_INDEX = 1;
const REFRESH_MS = 60000;

/* ===== CLOCK ===== */
function updateClock() {
  const now = new Date();
  time.textContent = now.toLocaleTimeString("fr-FR");
  date.textContent = now.toLocaleDateString("fr-FR", {
    weekday: "long", day: "2-digit", month: "long", year: "numeric"
  });
}
setInterval(updateClock, 1000);
updateClock();

/* ===== SHEET / CAROUSEL ===== */
const messageEl = document.getElementById("message");
const pcSelect = document.getElementById("pcSelect");

let rows = [];
let messages = [];
let msgIndex = 0;
let delaySec = 15;
let carouselTimer = null;

async function loadSheet() {
  const selectedId = pcSelect.value;

  const url = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_INDEX}`;
  const r = await fetch(url, { cache: "no-store" });
  rows = await r.json();

  pcSelect.innerHTML = "";
  rows.forEach(r => {
    const opt = document.createElement("option");
    opt.value = r.id;
    opt.textContent = r.titre || r.id;
    pcSelect.appendChild(opt);
  });

  if (rows.some(r => r.id === selectedId)) {
    pcSelect.value = selectedId;
  }

  updateCarousel();
}

function updateCarousel() {
  const row = rows.find(r => r.id === pcSelect.value);
  if (!row) return;

  messages = [row.msg1, row.msg2, row.msg3].filter(m => m && m.trim());
  delaySec = parseInt(row.delay) || 15;
  msgIndex = 0;

  if (carouselTimer) clearInterval(carouselTimer);

  showMessage();
  carouselTimer = setInterval(nextMessage, delaySec * 1000);
}

function showMessage() {
  messageEl.style.opacity = 0;
  setTimeout(() => {
    messageEl.textContent = messages[msgIndex] || "—";
    messageEl.style.opacity = 1;
  }, 300);
}

function nextMessage() {
  if (messages.length <= 1) return;
  msgIndex = (msgIndex + 1) % messages.length;
  showMessage();
}

pcSelect.addEventListener("change", updateCarousel);

/* INIT */
loadSheet();
setInterval(loadSheet, REFRESH_MS);
</script>

</body>
</html>
